\documentclass[british,11pt]{scrartcl}

\title     {Reine Intonation und Microtuning}
\author    {Florian Kranhold}
\subtitle  {Eine Abhandlung}

\input{preamble}

% % Kopfzeilen können wie folgt ergänzt werden
\usepackage{scrlayer-scrpage}
\lohead{F.\ Kranhold}
\cohead{}
\rohead{Reine Intonation und Microtuning: Eine Abhandlung}
\pagestyle{scrheadings}

\begin{document}

\maketitle

\begin{abstract}
  In dieser Arbeit entwickeln wir die mathematischen und musikalischen
  Grundlagen  der reinen Intonation für die klassischen westlichen Musik,
  einschließlich des pythagoreischen, syntonischen und septimalen Kommas, sowie
  des Eulerschen Tonnetzes. Darauf aufbauend stellen wir ein System zum
  Microtunen von Vokalmusik vor. Unsere Herangehensweise ist theoretisch,
  d.h.\ wir wollen uns nicht auf ein Instrument mit einer endlichen Anzahl an
  Tasten beschränken. Dieser Aufsatz wird von mehreren Audiobeispielen
  begleitet, die für den Open-Source-Interpreter LilyPond geschrieben sind. Wir
  erklären im Anhang, wie man sie kompiliert.
\end{abstract}

\section{Einleitung und Überblick}
\label{sec:int}

Wir setzten vorraus, dass die Grundkonzepte klassischer
Musiktheorie bekannt sind: Töne, Intervallnamen, Diatonische Skalen, Akkorde,
Tonarten und der Quintenzirkel.

Wenn ein Instrument (z.B.\ die menschliche Stimme) einen Ton erzeugt, schwingt
ein „Material“ (wie eine Saite oder eine Luftsäule) mit einer gewissen Frequenz.
Je höher die Frequenz ist, desto höher ist der Ton. Ein \emph{Stimmungssystem}
weist jedem Ton eine Frequenz zu. Typischerweise beginnen wir mit der Fixierung
des \emph{Kammertons}, der Frequenz des a’, heutzutage bei $440$\,Hz. Von dort
leiten wir die anderen Tonhöhen wie folgt ab: Die einfachste Beziehung zwischen
Tönen ist die der \emph{Oktave}, die einem Frequenzverhältnis von $1:2$
entspricht, z.B.\ bekommt das a’’ die Frequenz $880$\,Hz zugewiesen. In dem
modernen Stimmungssystem der \emph{gleichstufingen Stimmung} wird die Oktave in
zwölf gleich große Schritte – genannt \emph{Halbtonschritte}, \acr{HTS} – 
aufgeteilt. Ein \acr{HTS} entspricht also dem Frequenzverhältnis
$2^{\smash{\frac1{12}}}:1$. Mit diesem Verhältnis kann nun jedem Ton eine
Frequenz zugewiesen werden; beispielsweise wird dem e’’ sieben \acr{HTS}
über dem a’ eine Frequenz von \looseness-1
\[440\,\text{Hz}\cdot 2^{\frac7{12}} \approx 659.26\,\text{Hz}\] zugewiesen. Und
hier könnte man erwarten, dass die Geschichte und dieser Aufsatz ihr Ende
haben. Allerdings stellt sich dieses Stimmungssystem als nicht optimal heraus
sobald mehrere Töne gleichzeitig erklingen. Die Physik™ lehrt uns, dass mehrere
Wellen konsonieren wenn ihre Frequenzen im Verhältnis kleiner, paarweise
teilerfremder Ganzzahlen stehen, z.B.\ $4:5:6:7$. Sehen wir uns nun einen
Durakkord mit kleiner Septime bestehend aus Grundton, großer Terz, reiner Quinte
und kleiner Septime an. Da eine große Terz aus four, eine reine Quinte aus
sieben und eine kleine Septime aus zehn \acr{HTS} besteht (bestehen?)\todo{Es  ist so spät abends. Ich kann kein Deutsch mehr.}
ist das Frequenverhältnis dieser vier gleichzeitig erklingenden Töne
\looseness-1\[1:2^{\frac4{12}}:2^{\frac7{12}}:2^{\frac{10}{12}}\approx
1:1.260:1.498:1.781.\]%
Die Beobachtung der reinen Stimmung ist nun, dass dieses Verhältnis zwar
\emph{ungefähr} aber nicht \emph{genau} $4:5:6:7$ ist.\todo{Historisch gesehen war die Entwicklung allerdings genau in die andere Richtung, oder? Erst hatte man Sachen woe $2:3$ und dann haben Leute bemerkt, dass man dadurch dass man Verhältnisse wählt die \emph{ungefähr} aber nicht \emph{genau} sind andere potentiell wünschenswerte Eigenschaften erhält.}
Die „Unreinheiten“, die wir hier sehen, sind deutlich kleiner als ein
\acr{HTS} deshalb drücken wir ihre Größe mit Hilfe der Einheit \emph{Cent} aus,
wobei $100\,\on{ct}$ einem gleichstufigen \acr{HTS} entspricht. Anders
ausgedrückt: Die Oktave (d.h.\ die Multiplikation mit $2$) umfasst
$1{,}200\,\on{ct}$. Wir können damit beispielsweise sehen, dass das Verhältnis
von $4:5$ einem Unterschied von
\[1{,}200\,\on{ct}\cdot \log_2(\tfrac54) \approx 386.31\,\on{ct}\]%
entspricht, es also von dem vier \acr{HTS} ($400\,\on{ct}$) großen Intervall um
$13.69\,\on{ct}$ abweicht. Diese Unterschiede „korrigiert“
\emph{reine Intonation} dadurch Akkorde systematisch zu \emph{microtunen}, also
die Töne ein kleines bisschen höher oder tiefer zu spielen je nach harmonischem
Kontext. Das ist natürlich auf Musikinstumenten mit zwölf Tasten pro Oktave
unmöglich; dort müssen andere Stimmungssysteme eingesetzt werden. Nur an der
Theorie und nicht an praktischen Lösungsansätzen interessiert werden wir
letztere hier nicht ausführen. Unabhängig davon \emph{ist} reine Intonation in
der musikalischen Praxis durchaus einsetzbar, z.B.\ im a cappella Gesang:
Menschen die professionell singen hören aufeinander um möglichst konsonant zu
singen und microtunen ihre Akkorde \emph{intuitiv}.

Dieser Aufsatz gibt die nötigen Microtunings explizit an und zeigt wie sie
konsistent durch ein Stück hinweg eingesetzt werden können. Dabei gehen wir in
drei Schritten vor:\looseness-1

\begin{enumerate}
\item Mit der Einführung der \emph{pythagoreischen Stimmung} erreichen wir,
  dass alle reinen Quinten das Frequenzverhältnis von $3:2$ haben. Dies wird
  dazu führen, dass beispielsweise \sharp G etwas höher wird als das \flat A;
  dieser Unterschied heißt \emph{pythagoreisches Komma}. Da wir aber nicht an
  ein Tasteninstument \todo{(oder die Realität überhaupt)} gebunden sind, ist
  das kein Problem, es zwingt uns nur dazu Enharmonik ernst zu nehmen. Der
  Quintenzirkel wird zu einer unendlichen \emph{Quintenreihe}. Von hier an ist
  unser Standardstimmungssystem das pytagoreische, das e’’ hat also eine
  Frequenz von $\frac32\cdot 440\,\text{Hz}=660\,\text{Hz}$ und nicht mehr
  $659.26\,\text{Hz}$.\looseness-1
\item Selbst im pythagoreischen System sind Dreiklänge nicht optimal gestimmt,
  z.B.\ wäre ein Dur-Dreiklang $64:81:96$ statt $4:5:6$. Die große Terz ist ein
  bisschen zu hoch; der Unterschied $\frac{81}{80}$ wird als \emph{syntonisches
  Komma} bezeichnet. Folglich bedeutet das Microtunen des Akkords eine
  Absenkung der großen Terz um ein syntonisches Komma. Wir erhalten eine zweite
  Quintenreihe, die um ein syntonisches Komma tiefer liegt, und wenn wir diesen
  Schritt in beide Richtungen wiederholen, können die entstehenden Reihen zum
  Eulerschen Tonnetz zusammengesetzt werden, in dem die Bestandteile von (Dur-
  und Moll-)Dreiklängen nebeneinander liegen und Dreiecke bilden. Da
  (gegen-)parallele Dreiklänge benachbarten Dreiecken entsprechen, eignet sich
  dieses Gitter gut für die klassische Tonharmonik, erklärt aber auch die so
  genannte \emph{Kommafalle} für bestimmte Akkordfolgen: eine häufige Quelle
  für Detonationen™ (das ist der Verlust der ursprünglichen Grundfrequenz).
\item \todo{change that. – Was und warum?} Selbst innerhalb des Eulerschen
  Tonnetzes ist ein Dur-Dreiklang mit kleiner Septime, der benachbarte
  Eckpunkte des Gitters verbindet, $36:45:54:64$ statt $4:5:6:7$. Die kleine
  Septime ist ein bisschen zu hoch; der Fehler $\frac{64}{63}$ wird als
  \emph{septimales Komma} bezeichnet. Mit Hilfe des syntonischen und des
  septimalen Kommas können wir nun die meisten Vierklänge in Bachs Vokalmusik
  beschreiben / besprechen.
\end{enumerate}

Dieser Ansatz unterscheidet sich in zwei Aspekten von der
Standardliteratur:\todo{Welche? – Das würde mich auch interessieren.} Erstens
machen wir das pythagoreische System zum bevorzugten und verfolgen alle
Abweichungen davon durch syntonische und septimale Kommata, während
klassischerweise für jede Tonart eine sogenannte ptolemäische Skala verwendet
wird, in der die Terz, die Sexte und die Septime standardmäßig um ein
syntonisches Komma erniedrigt werden. Die Ptolemäische Skala hat den Vorteil,
dass weniger Kommata verfolgt werden müssen; allerdings, werden wir darlegen,
aus welchen systematischen Gründen wir uns gegen ihre Verwendung entschieden
haben. Zweitens wird das septimale Komma in der Regel weggelassen,
wahrscheinlich weil die durch den Tritonus verursachte Spannung (zwischen der
kleinen Septime und der großen Terz) hörbar sein soll. Wir sind jedoch
überzeugt, dass die Beachtung des septimalen Kommas zu einem saubereren System
führt.

Bevor wir diesen Prozess beginnen, weisen wir darauf hin, dass diese Abhandlung
mit mehreren musikalischen Beispielen versehen ist, die am Seitenrand dieses
Dokuments angegeben sind\LY{m-4567} (dies ist ein erstes Beispiel, in dem ein
Dur-Akkord mit kleiner Septime zu hören ist, einmal in gleichstufiger Stimmung
und einmal genau $4:5:6:7$, wie oben beschrieben). Diese Beispiele wurden mit
dem Notensatzprogramm \verb!lilypond! geschrieben und kodieren entweder eine
\acr{PDF}-Datei (dann beginnt ihr Dateiname mit \verb!p-!), eine
\acr{MIDI}-Datei (\verb!m-!) oder beides (\verb!b-!). Auf
\href{https://fkranhold.de/jiam/}{\textsf{fkranhold.de/jiam}} sind die
Quelldateien, die Kompilate und, falls eine \acr{MIDI}-Datei unter diesen ist,
eine Audio-Konvertierung nach \acr{OGG} Vorbis zu finden. In \cref{sec:ly}
erklären wir, wie der Quellcode geschrieben ist und ermutigen alle, selbst zu
experimentieren.

\section{Reine Quinten und die pythagoreische Stimmung}

Wie bereits in \ref{sec:int} erwähnt, wollen wir uns zunächst mit dem genauen
Verhältnis einer reinen Quinte ($2:3$) beschäftigen. Die Differenz zur
gleichstufigen Quinte, nämlich
\[1{,}200\,\on{ct}\cdot \log_2(\tfrac32) - 700\,\on{ct} \approx 1.96\,\on{ct}\]%
wird manchmal auch \emph{Grad} genannt\todo{Man müsste eigentlich irgendwo mal sagen, dass das Grad $\frac{1}{12}$ des Pyth. Kommas ist. Und dass 12-EDO genau das tut: Das Pyth. Komma auf 12 Quinten aufteilen.}
und ist sehr klein, aber dennoch etwas das wir korrigieren wollen. Ohne die
Einschränkungen eines Instruments mit diskreten Tonhöhen kann dies leicht
erreicht werden, wenn wir akzeptieren, dass enharmonisch unterschiedene
Tonhöhen verschiedenen Frequenzen entsprechen können.

Dies mag auf den ersten Blick seltsam erscheinen, aber man kann sich davon
überzeugen, indem man eine übermäßige Sekunde (in einem angemessenen
harmonischen Kontext) mit einer kleinen Terz vergleicht und versucht, sie zu
singen: Wir sehen keinen Grund, warum sie genau das gleiche Frequenzverhältnis
haben sollten. Ein weiteres eindrucksvolles Beispiel ist in
\cref{fig:enhContext} zu sehen (das Audiobeispiel ist in gleichstufiger
Stimmung): In beiden Fällen ist das resultierende Intervall acht \acr{HTS} groß
(\flat e’\,-\,h’ und \sharp d’\,-\,h’), aber im ersten Fall klingt es
dissonant, da der Kontext nahelegt, dass es aus vier Ganztönen besteht, während
es im zweiten Fall konsonant klingt.

\begin{figure}[h]
  \centering
  \LY{b-enhContext}
  \includegraphics{ly/b-enhContext.pdf}
  \caption{Eine übermäßige Quinte ist keine kleine Sexte.}\label{fig:enhContext}
\end{figure}

Akzeptierend, dass Enharmonik eine Rolle spielt, machen wir uns die Tatsache
zunutze, dass es für jede enharmonisch verschiedene Tonhöhe (c’, \sharp h und
\dflat d’ sind drei unterschiedliche Beispiele!) eindeutig bestimmte ganze
Zahlen $p,q\in\Z$ gibt, so dass die Tonhöhe von a’ aus erreicht werden kann,
indem man $p$ reine Quinten und $q$ Oktaven nach oben geht (eine negative Zahl
bedeutet, dass man nach unten geht). Setzen wir den Kammerton auf $440\Hz$, so
ordnen wir der Tonhöhe die Frequenz $(\frac32)^p\cdot 2^q\cdot 440\Hz$ zu. Ein
Beispiel:\looseness-1
\begin{align*}
  \text{\sharp g’}&\equiv(\tfrac32)^5\cdot 2^{-3}\cdot 440\Hz\approx 417.66\Hz\\
  \text{\flat a’} &\equiv(\tfrac32)^{-7}\cdot 2^4\cdot 440\Hz\approx 412.03\Hz
\end{align*}
Der Unterschied zwischen diesen beiden Frequenzen heißt
\emph{pythagoreisches Komma} und ist
$3^{12}\cdot 2^{-19}\approx 23.46\,\on{ct}$. Eine verminderte Sexte
unterscheidet sich von einer reinen Quinte notwendigerweise um genau dieses
pythagoreische Komma. Eine verminderte Sexte wird in der pythagoreischen
Stimmung manchmal als „Wolfsintervall“ bezeichnet, da sie sehr verstimmt
klingt, siehe \cref{fig:pythComma}. In \cref{fig:spiral5}, ist eine
enharmonische Variante des Quintenzirkels zu sehen, die wir als
\emph{Quintenspirale} bezeichnen können. Mit jeder vollen Runde in dieser
Spirale, verschiebt sich die Tonhöhe um ein pythagoreisches Komma.\todo{Hier ein Wort zu Skalen?}

\begin{figure}[h]
  \centering
  \includegraphics{ly/b-pythComma}
  \LY{b-pythComma}
  \caption{(1) Der Unterschied zwischen \sharp g’ and \flat a’. (2) Das
    Wolfsintervall \sharp g’\,–\,\flat e’, gefolgt von der reinen Quinte \sharp
    g’\,–\,\sharp d’.}\label{fig:pythComma}
\end{figure}

Für jedes Intervall können wir das entsprechende Verhältnis berechnen, siehe
\cref{tab:1}. Man beachte, dass, wenn ein bestimmtes Intervall das Verhältnis
$a:b$ hat, sein \emph{Komplementärintervall} das Verhältnis $b:2a$ hat, z.B.\
eine kleine Sexte entspricht dem Verhältnis $81:128$. Ähnlich verhält es sich,
wenn ein Intervall die Größe $c$ in Cent hat: Dann hat sein
Komplementärintervall die Größe $1{,}200\,\on{ct}-c$, z.B.\ eine kleine Sexte
entspricht $792.18\,\on{ct}$.

\begin{figure}
  \centering%
  \input{tikz/spiral5}
  \caption{Die enharmonische Quintenspirale. Mit jeder vollen Rotation im
  	Uhrzeigersinn, gewinnen wir ein pythagoreisches Komma.}\label{fig:spiral5}
\end{figure}

\begin{table}
  \centering
  \begin{tabular}{lr@{\hspace*{2.4px}}lr}
    \toprule
    \textsc{Intervall} & \multicolumn{2}{c}{\textsc{Verhältnis}} & \textsc{Größe in ct}\\
    \midrule
    kleine Sekunde  & $243$ & $:256$ &  $90.22$\\
    große Sekunde   & $8$   & $:9$   & $203.91$\\
    kleine Terz     & $27$  & $:32$  & $294.13$\\
    große Terz      & $64$  & $:81$  & $407.82$\\
    reine Quarte    & $3$   & $:4$   & $498.04$\\
    \bottomrule
  \end{tabular}
  \caption{Ausgewählte Intervalle in pythagoreischer Stimmung.}\label{tab:1}
\end{table}

Von nun an interpretieren wir geschriebene Noten in die pythagoreischer
Stimmung und bezeichnen alle Abweichungen davon mit bestimmten Symbolen, die
wir einführen, wenn sie notwendig werden. Man beachte jedoch, dass der
Unterschied zu der gleichstufigen Stimmung eher gering ist.\todo{(Außer man schreibt verrückte Sachen wie \dflat h und \dsharp g. Die unterscheiden sich in 12-EDO nicht, aber in pyth. Stimmung um $46.9\,\on{ct}$.)}
Während alle noch kommenden Mikroalterationen (die darauf abzielen, ganze
Akkorde zu stimmen) den Preis haben werden, dass es mehrere Frequenzen für
denselben Tonnamen gibt, verwendet die bare pythagoreische Stimmung nur die
Informationen, die uns durch die geschriebenen Noten gegeben werden. Sie verhält
sich aus \emph{melodischer} Perspektive also gut™, da die Größe der 
(horizontalen) Intervalle nicht von der vertikalen Struktur abhängt.\todo{Also ein Beweis ist das nicht, oder? Einen Grund dafür, dass pythagoreische Stimmung für sinnvolle Melodien sorgt, habe ich in der Rotation des Mikrotöne-Kurses auf der zweiten Hälfte vorgeführt bekommen: In pythagoreischer Stimmung gibt es \emph{diatonische} Skalen, also Skalen die nur zwei unterschiedliche Schrittweiten haben (i.e.\ Halbton und Ganzton). In der Rotation hat Georg so ein 22-EDO Beispiel vorgespielt mit $\text{GT}:\text{HT} = 4:1$. Das Beispiel produziert grauenhafte Dreiklänge, aber eine Tonleiter mit LLSLLLS hörte sich relativ melodisch an und war eindeutig Dur.}

Der einzige Nachteil der pythagoreischen Stimmung, der nichts mit der Realisierbarkeit auf einem diskretisierenden Instrument zu tun hat, sondern rein theoretisch ist, ist die Tatsache, dass sie die Unreinheit der Terzen in einem Dreiklang im Vergleich zur gleichstufigen Stimmung sogar noch erhöht: Der Unterschied zwischen einer pythagoreischen großen Terz ($407.82\,\on{ct}$) und dem oben erwähnten Verhältnis $4:5$ ($386.31\,\on{ct}$) beträgt $21.51\,\on{ct}$. Dieser Fehler ist Gegenstand des nächsten Abschnitts.

% We close this section by considering a three harmonic situations, which could
% appear in western classical music and which require enharmonic sensitivity, see
% \cref{fig:reint}: In the first case, we have a dominant seventh in \flat E major,
% leading to the tonic, while in the second case, we see the German augmented
% sixth chord (which might be seen as a variation of a dominant chord based on E),
% leading to A major. The third example shows how a diminished seventh chord can
% be enharmonically reinterpreted: It is introduced as the dominant of A minor,
% but then reinterpreted as the dominant of C minor, leading to the new tonic. We
% play these chords in Pythagorean tuning.

% \begin{figure}[h]
%   \centering%
%   \includegraphics{ly/b-reint.pdf}%
%   \LY{b-reint}%
%   \caption{Three situations showing the different rôles of \sharp G and \flat
%     A.}\label{fig:reint}
% \end{figure}

\section{Dreiklänge und das Eulersche Tonnetz}

\subsection{Das syntonische Komma}

Wir beginnen mit der Beobachtung, dass in der pythagoreischen Stimmung ein
Dur-Dreiklang dem Verhältnis $64:81:96$ statt $4:5:6=64:80:96$ entspricht,
d.h.\ die große Terz etwas zu hoch ist (im Hörbeispiel hören wir zuerst einen
pythagoreischen Dur-Dreiklang und dann $4:5:6$).\LY{m-pyth456} Der Unterschied,
$\frac{81}{80}\approx 21.51\,\on{ct}$, heißt das
\emph{syntonische Komma}.\todo{Hier wird einigen Leuten auffallen (naja, vllt. auch nicht, aber egal), dass das syntonische Komma und das pythagoreische fast gleich groß sind und sich nur um das \emph{Schisma} $\approx 1.95 \,\on{ct}$ unterscheiden (insbesondere ist d – \flat g – a ein fast reiner Durdreiklang). Da könnte man nun denken, dass das Schisma genau das \emph{Grad} ist, aber das stimmt nicht. Sie unterscheiden sich um $\approx 0.00128 \,\on{ct}$. Das heißt, dass das gleichstufige e’’ (a’ + Quinte - Grad) und das \flatp f’’ (a’ + Quinte - Schisma) eine Schwebungsperiode von ~34 Minuten haben.}
In anderen Worten: Die große pythagoreische Terz $81:64$ ist um ein syntonisches
Komma größer als $4:5$, und die kleine pythagoreische Terz $27:32$ ist ein um
ein syntonisches Komma kleiner als $5:6$, denn $5:6$ ist das Komplement von
$4:5$ in $2:3$ und damit die gewünschte kleine Terz. Von nun an nennen wir das
Verhältnis $4:5$ eine \emph{reine} große Terz und $5:6$ eine \emph{reine} kleine
Terz. Folglich nennen wir ihre zur Oktave komplementären Intervalle $5:8$ und
$3:5$ die \emph{reine} kleine bzw. große Sexte.\looseness-1

Wenn man versucht, Tonhöhen um ein syntonisches Komma zu alterieren, um die
Stimmung zu verbessern, stößt man auf das Problem, dass jeder Ton prinzipiell
die große Terz, aber auch der Grundton eines Dreiklangs sein kann. Das bedeutet:
Es hängt vom harmonischen Kontext ab, ob eine Tonhöhe alteriert werden muss
oder nicht, und das lässt sich leider nicht aus dem bloßen (Enharmonik
beachtenden) Tonnamen herauslesen.\looseness-1

Bei einer Partitur fügen wir die zusätzliche Information, dass bestimmte Noten
um ein oder mehrere syntonische Kommata abgesenkt oder angehoben werden müssen,
durch die Einführung weiterer Vorzeichen in der Tradition von Helmholtz und
Ellis \cite{HE} hinzu: Die Vorzeichen \dsharpp, \sharpp, \naturalp, \flatp, und
\dflatp\ bedeuten die Erhöhung des Tons um ein syntonisches Komma; genauso
bedeuten \dsharpp, \sharppp, \naturalpp, \flatpp, und \dflatpp\ zwei Kommata und
so weiter. In die andere Richtung benutzen wir \dsharpm, \sharpm, \naturalm,
\flatm, und \dflatm\ für Noten die um ein syntonisches Komma tiefer erklingen
sollen. Ein Beispiel ist in \cref{fig:HE} zu sehen. Wie üblich gelten Vorzeichen
für einen ganzen Takt; wenn also ein einzelner Takt erst \naturalm a' und dann
\natural a' enthält, sind beide Vorzeichen verpflichtend. Aus Gründen, die im
nächsten Unterabschnitt erläutert werden, verwenden wir überhaupt keine
Generalvorzeichen.\looseness-1

\begin{figure}\centering
  \includegraphics{ly/p-HE}
  \LY{p-HE}
  \caption{Im ersten Takt ist das \sharp f’ um ein syntonisches Komma 
    tiefalteriert, sodass wir einen Dur-Dreiklang $4:5:6$ erhalten. Im zweiten
    Takt wird das g’ um eines, das \flat e’’ um zwei syntonische Kommata hoch
    alteriert, sodass sich eine reine kleine Sexte $5:8$ ergibt.}\label{fig:HE}
\end{figure}

\subsection{The Euler lattice}

Let us now try to implement syntonic commata consistently throughout an entire
piece of music: One classical approach is to alter the major scale and lower
those notes that most likely appear as major thirds of a triad—namely: third,
sixth, and seventh. The result is called the \emph{Ptolemaic scale}.  Fixing the
frequency of the root of the scale, the frequencies of all notes appearing in
the scale can be computed as
$1,\frac98,\frac54,\frac43,\frac32,\frac53,\frac{15}8,2$. We decided against
using that scale (in fact, we avoid the word ‘scale’ altogether) for the following
reasons:
\begin{enumerate}
\item In the Ptolemaic scale, the fifth between the second and the sixth tone is
  not $2:3$, but $27:40$. Therefore, in order to play the parallel of the
  subdominant (e.g.\ D minor in C major), we again have to alter one of the
  notes by a syntonic comma.\todo{Ich würde sagen, dass hier Wichtig ist, dass die Sp ähnlich häufig ist wie die D. Wenn das nicht so wäre könnte man einfach sagen: „Naja, dafür sind halt Versetzungszeichen da. Denn das \flat E ist in F-Dur halt seltener als das E. Genauso ist das \natural E seltener als \naturalm E, weshalb es sinnvoll ist \naturalm E per default zu haben.“ Das Problem ist halt, dass das Argument bei dem zweiten Ton der Durskala nicht funktioniert weil zwei unterschiedliche Syntonisierungen ähnlich häufig sind.}
\item The Ptolemaic scale only gives \emph{some} pitches a frequency. However,
  there are several pitches that are ‘closely related’ to a certain scale, even
  though they do not strictly belong to it (e.g.\ \sharp F in C major, as it
  is the major third of the double dominant).
\item Our basic tuning system should not depend on the key of the piece,
  but only on the concert pitch.\todo{Ich bin mir nicht sicher ob ich diesen Punkt verstehe. Das Stimmungssystem ändert sich ja durch die Vorzeichen nicht, oder? Ich bin verwirrt.}
\end{enumerate}
Instead, we want to arrange all possible frequencies of a piece in a way that
reflects harmonic proximity. This is typically achieved by the \emph{Euler
  lattice}, see \cref{fig:latticeExcerpt}: We start with the spiral of fifths,
now written as a single horizontal line, and we subdivide each step ($2:3$) into
a just major third ($4:5$) and a just minor third ($5:6$). The intermediate
pitch is placed between the start and the end, but slightly lower. Subdividing
all steps, we obtain an entire new line below, which again consists of perfect
fifths, but now, the frequencies in this line are lowered by a syntonic comma.
The very same can be done in the other direction, by exchanging the order of
major and minor this, and denoting the intermediate note slightly above.  We
obtain a new line of fifths where all frequencies are raised by a syntonic
comma. Iterating this process in both directions, we obtain a lattice of
pitches, see \cref{fig:latticeExcerpt}, where a movement of the form ‘$\to$’
corresponds to a perfect fifth, while ‘$\searrow$’ corresponds to a just major
third and ‘$\nearrow$’ corresponds to a just minor third. Each
(enharmonic-sensitive) pitch class (i.e.\ forgetting the octave) appears exactly
once in each line, so a vertex in the lattice is the same as a pitch class,
together with a number of syntonic commata applied to it.

\begin{figure}[h]
  \input{tikz/latticeExcerpt}
  \caption{An excerpt of the Euler lattice. We calculated all frequences as
    factors relative to C, octave-normalised so that they lie between $1$ and
    $2$.}\label{fig:latticeExcerpt}
\end{figure}

In this lattice, a triangle of the form $\triangledown$ captures the ingredients
of a justly intonated major chord ($4:5:6$), while a triangle $\vartriangle$
captures those of a minor chord ($10:12:15$). Adjacent triangles either share a
fifth, i.e.\ they are \emph{variants} of each other, or a third, i.e.\ they are
in \emph{parallel} ($\vartriangle\!\!\!\triangledown$) or \emph{counterparallel}
($\triangledown\!\!\!\vartriangle$) relation to each other.  Fixing one triangle
as the tonic of a piece, we easily recover the standard functions like
(sub-)dominant, as well as their (counter-)parallels, and even intermediate
dominants: For a given triangle, its \emph{intermediate dominant} is the major
triangle containing the fifth on the right side of the given one (e.g.\ the
double dominant of C major is the D major triad on the middle right of
\cref{fig:latticeExcerpt}, not the one on the bottom left).

\subsection{Microtune functional harmonies}

Given a piece of music (e.g.\ \cref{fig:triadPiece}), one first determines its
key (E minor).  Then the tonic triangle in the Euler lattice is uniquely
determined by the mode (major or minor) and the requirement that the \emph{root}
(here: E) is not altered by a comma. For each ocurring note, we then determine,
by looking at all voices, the triad it is part of (the fourth note of the tenor,
$\rA_3$, is part of a D major triad), determine the function of the triad
(dominant of the tonic parallel), and find the according triangle in the Euler
lattice (see \cref{fig:chordsLattice} for all triads appearing in
\cref{fig:triadPiece}, located in the Euler lattice). This then tells us exactly
how many commata we have to apply to the note (here: $\rA$ has to be raised by
one). Its absolute frequency is
$\frac{81}{80}\cdot 220\,\text{Hz}=222.75\,\text{Hz}$, and relative to the next
lower occurence of the root, namely $\rE_3$, it corresponds to the factor
$\frac{81}{80}\cdot \frac{4}{3}=\frac{27}{20}$.

We point out that for a piece in C major, the root of an A minor triad is
lowered by a syntonic comma, while this is clearly not the case for a piece in A
minor—even though the piece would have the same key signature. Therefore, given
a piece with a certain key signature, the usual decision which of the two
possible triads are the tonic (e.g.\ C major or A minor) has an effect on how
high the piece is supposed to be intonated.  This might sound strange, but
follows once we agree that the root of the tonic should, as the centre of the
piece, by derived directly from the concert pitch.\todo{Ein weiterer Grund: Wenn wir ein F-Dur Stück in \naturalm F schreiben, hat fast jeder Ton ein Versetzungszeichen und es wird unlesbar. Ich bin mir nicht sicher, ob ich den Grund mit dem Kammerton mag, aber wahrscheinlich denke ich zu praktisch darüber nach: Wenn ich für ein Stück in \flat B-Dur die Töne mit einer Stimmgabel angebe, dann kommt dabei eher sowas wie \flatp B-Dur heraus, denn ich werde an den $15:16$ Leitton denken und nicht das $243:256$ Limma.}

\begin{figure}
  \centering
  \LY{b-triadPiece}
  \includegraphics{ly/b-triadPiece}
  \caption{A schematic four-part harmonic piece in E minor (using only triads),
    with im\-ple\-men\-ted syntonic commata.  There are two audio renderings of
    the piece, one in bare Pythagorean tuning, and one which uses the syntonic
    commata for correction.\looseness-1}\label{fig:triadPiece}
\end{figure}

\begin{figure}
  \input{tikz/chordsLattice}
  \caption{Triads appearing in \cref{fig:triadPiece}, located in the Euler
    lattice.}\label{fig:chordsLattice}
\end{figure}

\subsection{Comma drift}

If we once again take a look at the excerpt of the Euler lattice in
\cref{fig:latticeExcerpt}, then we find two occurences of the pitch $\rD$ in the
proximity of $\rC$, namely \naturalm $\rD\,(\frac{10}9)$ and $\rD\,(\frac98)$. Both
vertices appear as triangles corresponding to functions in C major: The first
one as the root of D minor (parallel of the subdominant, or \textsc{ii} in Roman
numeral analysis) and the second one as the fifth of G major (dominant, or
\textsc{v}).  Now imagine a piece that contains the functions \textsc{ii} and
\textsc{v} directly after each other, and one voice having the root of
\textsc{ii}, holding it while it becomes the fifth of \textsc{v}, see
\cref{fig:drift}.  Then there are two possibilities:

\begin{enumerate}[itemsep=0em]
\item One of the chords is transposed by a syntonic comma.
\item The holding voice \emph{adjusts} the intonation when the harmony changes.
\end{enumerate}%
%
What typically happens in vocal music is the first possibility, just because the
usual interpretation of holding a note is—obviously—not to change it, and the
remaining voices, which have to move, find their just intonation in relation to
the holding voice.  The consequence is that the second chord (\textsc{v}) is
lowered by a syntonic comma and the ensemble loses intonation, i.e.\ it
\emph{detonates}, see the first part of \cref{fig:drift}.  This effect is called
the \emph{comma drift}.  Note that if this phenomenon occurs five times, the
amount of the detonation will be $5\cdot 21.51\,\on{ct}=107.55\,\on{ct}$, i.e.\
the ensemble will have detonated by more than an equally-tempered semitone.

The more desirable solution, which yet requires the singers to understand the
harmonic situation, is the second one, denoted in the second part of
\cref{fig:drift}.  This is a striking example showing that the theoretical
knowledge of just intonation (which, as we claimed, choir singers tend to use
intuitively) can help tracking down the source of a very practical and common
issue, namely that of loosing intonation.

The chord progression \textsc{ii}\kern1px–\kern1px \textsc{v} is not the only
one that can cause comma drifts. The third part of \cref{fig:drift} shows a
modulating chord progression that involves the double dominant. Here even two
voices, which are a fifth apart from each other, have to adjust their
intonation.  Note that the simultaneous adjustments assemble into a ‘movement’
in parallel fifths, but that clearly\todo{(For a person not well versed in classical counterpoint it \emph{might} just be helpful if you explained this anyway.)}
does not violate the rules of classical counterpoint.

We point out that the ‘correct’ intonation depends on the interpretation of the
function that the triad represents.  For example, if one interprets, in the
first part of \cref{fig:triadPiece}, the D minor chord as the variant of the
double dominant (which would be absurd,\todo{Yes, it would be absurd. Can we create an example where it would \emph{really} be up for debate which syntonic level a chord should be assigned to?}
but just for the sake of argument), then the chord would have to be played a syntonic
comma higher, and the subtleties of the comma drift apply to the chord change
\textsc{vi}\kern1px–\kern1px\textsc{ii} one beat earlier.

\begin{figure}
  \centering
  \LY{b-drift}
  \includegraphics{ly/b-drift}
  \caption{(1) A chord progression where all repeated pitches are intonated in
    the same way, causing a detonation by a syntonic comma.%
    \quad(2) The same chord progression with the necessary adjustment (indicated
    by a zig-zag line): Between the third and the fourth chord, the soprano has
    to adjust their $\rD_5$%
    \quad(3) A similar situation where even two voices have to make an
    adjustment, causing a movement by a comma in ‘parallel
    fifths’.}\label{fig:drift}
\end{figure}

\subsection{A word on prime numbers}

…\todo{Oh! Was soll hier hin kommen?}

\section{Advanced harmonies}

In the previous section, we learned how to tune pieces where each note is part
of a major or minor triad.  However, chords very often have other ingredients
than just the root, the third, and the fifth.  In this section, we discuss the
most important variations of major and minor chords and how to tune them.

\subsection{Suspended fourth and extended ninth}

The \emph{suspended fourth chord} consists of the root, the fourth and the
fifth; and typically, the fourth leads into the (major or minor) third on the
next beat.  The suspended fourth chord needs no correction by a syntonic comma;
it corresponds to the ratio $6:8:9$ in bare Pythagorean tuning.\todo{Note that the fourth is \emph{just} in Pythagorean tuning ($3:4$), also it requires no correction if the suspended fourth follows the subdominant where it was the root.} Resolving the
fourth into the major third is a semitone of size
$15:16\approx 111.73\,\on{ct}$,\todo{Same sized step as leading note’s resolution. Maybe refer to \cref{sec:ln}?} and resolving the fourth into the minor third is
a whole tone of size $9:10\approx 182.40\,\on{ct}$.\todo{Überbindung ohne korrektur.}

In the \emph{extended ninth chord} consists of a (major or minor) chord,
together with an additional major ninth. This ninth lies a perfect fifth above
the fifth of the triad, and hence has the same amount of commata as the root
and the fifth. This chord then corresponds to the ratio $4:5:6:9$ in major, and
to $20:24:30:45$ in minor. We note that the semitone between the major ninth and
the minor third (plus an octave) equals $15:16$.\todo{Maybe we could also argue why an other syntonisation of the ninth is rather undesirable (after all the ninth that is one syntonic comma lower is still reasonably close to the root of the chord in the Euler lattice so it might deserve to be looked at).}

On \cref{fig:chordLines}, we have depicted the above chords as subcomplexes of
the Euler lattice. We decided to not only mark the vertices, but also highlight
all direct edges between them, as each edge stands for a relation of the form
$2:3$, $4:5$, or $5:6$ inside the chords.

\subsection{Subdominant sixth}

Very often, the subdominant chord (in both major and minor) comes together with
the major sixth above the root of the chord (e.g.\ $\rF:\rA:\rC:\rD$ in C major,
or $\rF:\text{\flat A}:\rC:\rD$ in C minor).  In the major case, this chord is
an amalgamation of two triads, which share a third (in the example: F major and
D minor). Accordingly, we shall use the vertices of the adjacent triangles
$\vartriangle\!\!\!\triangledown$ to deduce the tuning of its ingredients, see
\cref{fig:chordLines}. We obtain the ratio $12:15:18:20$. Note that when the
subdominant sixth is followed by the dominant, the major sixth has to be
adjusted when changing the harmony, see \cref{fig:496}.\todo{Das andere aber wichtiger.}

The situation is more tricky in minor, as the subdominant sixth is not an
amalgamation as above. We argue why we should instead use the major sixth
on the same comma level as root and fifth, and not the one a comma lower:
\begin{itemize}
\item \naturalm $6$ is not part of any triad in the harmonic proximity of the
  tonic; this is different in the major case.
\item \natural $6$ of the subdominant coincides with \natural $5$ of the
  dominant, so even\todo{Am I missing something? Why “even”?}
  if the subdominant sixth is followed by the dominant, with one voice keeping the 
  common note, no adjustment is necessary.
\item The tritone between \flatp $3$ and \naturalm $6$ is very small, namely
  $18:25\approx 568.71\,\on{ct}$, which is $31.29\,\on{ct}$ smaller than the
  equally-tempered one.\todo{Why is this an argument? Equal temperament has not been an argument before. Is it because the tritone is actually \emph{supposed} to be dissonant and therefore being close to $1:\sqrt{2}$ is desired?}
\item The semitone that lies between \flatp $3$ of the tonic and \naturalm $6$
  of the subdominant is $25:27\approx 133.28\,\on{ct}$, which is way too
  large. In the third part of \cref{fig:496}, this large semitone appears as a
  horizontal interval for the tenor.
\end{itemize}
The resulting chord has the ratio $80:96:120:135$, and the tritone between the
minor third and the major sixth is $32:45\approx 590.22\,\on{ct}$, which is much
closer to the equally-tempered one ($600\,\on{ct}$) than $18:25$.\looseness-1

\begin{figure}
  \centering
  \LY{b-496}
  \includegraphics{ly/b-496}
  \caption{Four examples including the suspended fourth, the extended ninth and
    the subdominant sixth. The difference between the second and the third
    example is only a single note in the tenor: The first version uses the major
    sixth which we propose, the second version the one a comma lower, including
    $25:27$ as a horizontal interval.}\label{fig:496}
\end{figure}

\begin{figure}
  \centering
  \input{tikz/chordLines}
  \caption{Suspended fourth, extended ninth, and subdominant sixth in both major
    (top row) and minor (bottom row), visualised as subcomplexes of the Euler
    lattice.}\label{fig:chordLines}
\end{figure}

\subsection{Dominant seventh}


No tetrad in the Euler lattice could possibly contain the
desired interval $4:7$ (just because only the primes $2$, $3$, and $5$ are
involved).\todo{Allerdings haben wir auch mal gesagt, dass die Naturseptime nicht immer gut klingt. Deshalb sollten wir trotzdem die $9:16$ Septime als Alternative einführen.}


\subsection{Diminished seventh}


\subsection{Seventh Ninth}

+ Comparison SN with Minor Sixte ajoutée

\begin{table}
  \centering
  \begin{tabular}{lrrrrr}
    \toprule
    \textsc{chord} & \multicolumn{4}{l}{\textsc{ratio}}\\
    \midrule
    Major                     & $4$  & $5$  & $6$\\
    Minor                     & $10$ & $12$ & $15$\\
    Suspended fourth          & $6$  & $8$  & $9$\\
    Extended ninth (major)    & $4$  & $5$  & $6$  & $9$\\
    Extended ninth (minor)    & $20$ & $24$ & $30$ & $45$\\
    Subdominant sixth (major) & $12$ & $15$ & $18$ & $20$\\
    Subdominant sixth (minor) & $80$ & $96$ & $120$ & $135$\\
    Dominant seventh          & $4$  & $5$  & $6$  & $7$\\
    Diminished seventh        &      & $25$ & $30$ & $35$ & $42$\\
    Seventh ninth             &      & $5$  & $6$  & $7$  & $9$\\
    \bottomrule
  \end{tabular}
\end{table}

\section{Melody versus Harmony}

\subsection{Steps as horizontal intervals}

\subsection{Intermediate notes}

Durchgänge, Wechselnoten

\subsection{Leading-notes}
\label{sec:ln}

We point out that the third in triad belonging to the dominant (or some
intermediate dominant) is lowered by a syntonic comma as well, which contradicts
the common practice of intonating leading-notes slightly higher in order to
increase the tension, see e.g.\ […]\todo{Literature}. We are convinced that the
dominant should be a stable major triad in its own right, but the reader might
disagree with us on this matter. In this case, we propose to raise the
leading-note by a syntonic comma, giving the triad the Pythagorean tuning
$64:81:96$.  (In the audio example you hear two versions of a cadence, one with
a justly intonated leading tone; one with a Pythagorean leading tone.)  We,
however, stick to the convention of intonating all triads, including such that
have a dominant function, such that they have a just third.

\begin{figure}
  \centering
  \LY{b-lead}
  \includegraphics{ly/b-lead}
  \caption{Two ways of intonating a full cadence: Once with all major triads
    being justly intonated, and one with a Pythagorean leading-note.}\label{fig:lead}
\end{figure}

\appendix

\section{How the LilyPond code works}
\label{sec:ly}

% We give them as source code, written in the audio
% programming language \texttt{csound}, for which an interpreter is freely
% available \cite{csound}. We explain in \cref{sec:ly} how the code can be
% compiled, but here is already a short explanation how one can make sense of it:
% There are two ways of prescribing specific frequencies: The first way (encoded
% by \verb!i1!) corresponds to \emph{equal temparament}: a pitch is given by a
% \emph{root frequency} (the once fixed base of a piece, e.g.\ $330$\,Hz for the
% Pythagorean $\text{E}_4$) and the difference to that root, expressed as a number
% of semitones. The second way (encoded by \verb!i2!)  sets frequencies by a root
% frequency and a \emph{fraction}, consisting of a numerator and a denominator,
% with which the root frequency has to be multiplied:
% \begin{quote}\small
%   %\begin{multicols}{2}
%     \verb!t  0 90!\marginnote{\texttt{ex01.sco}}\\
%     \verb!i1 0 6 330  0!\\
%     \verb!i1 1 5 .    4!\\
%     \verb!i1 2 4 .    7!\\
%     \verb!i1 3 3 .   10!\\
%    % ~\\
%     %~\\
%     \verb!i2 6 6 330  1 1!\\
%     \verb!i2 7 5 .    5 4!\\
%     \verb!i2 8 4 .    3 2!\\
%     \verb!i2 9 3 .    7 4!\\
%     \verb!e!
%   %\end{multicols}
% \end{quote}
% %Note that this code is written in two columns; it contains $10$ lines in total.
% The first line sets the tempo to $90$ beats per minute. We will often skip this
% line; then the tempo is, by default, $60$ beats per minute (the reader should
% feel free to adjust it to their need).

% Each of the following lines stands for a single note. In every line, the first
% entry after \verb!i1! or \verb!i2! gives the starting beat, while the second
% entry gives the duration, e.g.\ the first note starts at time $0$ and lasts $6$
% beats. In total, we hear two tetrads, with a slow arpeggio.

% The third entry sets the root frequency (once mentioned for the first note; then
% repeated, by the dot, for all following lines), and for the final entries, it
% matters whether we use \verb!i1! or \verb!i2!: In the first case, it gives the
% number of semitones we deviate from the base frequency, and in the second case,
% it gives the numerator and denominator of the fraction. Altogether, we should
% hear the major triad with minor seventh, once in equal temparament and once in
% just intonation. The \verb!e! indicates the end of the score.

% As it is generally painful to copy the source code out of the \acr{PDF} file,
% and since we sometimes only indicate the general pattern for a longer audio
% example, we have collected all necessary files on
% \href{https://fkranhold.de/jiam/}{\textsf{fkranhold.de/jiam}}. The name of the
% specific file is denoted at the page margin, as above \texttt{ex01.sco}.

\printbibliography[heading=bibintoc]

% Adressen der Autoren
\addr{Florian Kranhold}{%
  Karlsruhe Institute of Technology,
  Englerstraße 2,
  76131 Karlsruhe,
  Germany,
  \mail{kranhold@kit.edu}.}

\end{document}
